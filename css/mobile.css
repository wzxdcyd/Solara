/* =========================================
   Solara Mobile UI - Responsive Desktop Adaptation
   ========================================= */

/* 
   Goal: Replicate the Desktop UI exactly but fit it into a vertical mobile screen.
   Inherits all base styles from css/style.css.
*/

@media screen and (max-width: 820px) {

    /* --- 1. Global Layout & Background --- */
    html, body {
        overflow: hidden; /* Container handles scrolling */
        height: 100dvh;
        width: 100vw;
        /* Ensure body is transparent so the background-stage (gradients) from style.css shows through */
        background: transparent !important; 
    }

    /* Ensure the gradient background layer is visible and fixed */
    .background-stage {
        display: block !important;
        position: fixed;
        inset: 0;
        z-index: -2;
    }

    /* --- 2. Main Container Transformation --- */
    /* Convert the fixed aspect ratio Grid into a flexible Flex Column */
    .container {
        display: flex !important;
        flex-direction: column;
        width: 100% !important;
        height: 100% !important;
        max-width: none !important;
        max-height: none !important;
        margin: 0 !important;
        border: none !important;
        border-radius: 0 !important;
        
        /* Glassy effect consistent with Desktop */
        background: rgba(255, 255, 255, 0.05) !important;
        box-shadow: none !important;
        
        /* Padding for SafeArea */
        padding: 10px !important;
        padding-top: calc(env(safe-area-inset-top) + 10px) !important;
        padding-bottom: calc(env(safe-area-inset-bottom) + 10px) !important;
        
        gap: 12px;
        box-sizing: border-box;
    }

    /* Dark mode override for container */
    body.dark-mode .container {
        background: rgba(30, 30, 30, 0.4) !important;
    }

    /* --- 3. Component Reordering & Sizing --- */

    /* [Header] Keep it compact */
    .header {
        flex: 0 0 auto;
        padding: 0 !important;
        margin: 0 !important;
        background: transparent !important; /* Remove card bg for header to save space */
        display: flex !important;
        justify-content: space-between;
        align-items: center;
        border: none !important;
        box-shadow: none !important;
    }
    .header h1 {
        font-size: 1.5rem !important;
        text-align: left;
        margin-left: 10px;
    }
    .theme-switch-wrapper {
        position: static !important;
        transform: none !important;
    }
    .header .warning { display: none; }

    /* [Search] */
    .search-area {
        flex: 0 0 auto;
        padding: 10px !important;
        margin: 0 !important;
        /* Keep glass card style from style.css */
    }
    .search-container { margin-bottom: 0 !important; }
    .search-input { padding: 10px !important; }
    
    /* Force search results to float over everything if active */
    .search-results {
        position: absolute;
        top: 130px; /* Approx header + search height */
        left: 10px;
        right: 10px;
        bottom: 100px;
        z-index: 1000;
        background: rgba(20, 20, 20, 0.95) !important;
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255,255,255,0.1);
        border-radius: 12px;
        overflow-y: auto;
        padding: 10px !important;
        /* Hidden by default via opacity in style.css, but ensure layout works */
    }

    /* [Cover & Info] Side-by-side on mobile to save vertical space */
    .cover-area {
        flex: 0 0 auto;
        display: flex !important;
        flex-direction: row !important;
        align-items: center;
        justify-content: flex-start;
        gap: 15px;
        padding: 10px !important;
        text-align: left !important;
        min-height: auto !important;
    }

    .album-cover {
        width: 80px !important;
        height: 80px !important;
        min-height: 0 !important;
        margin-bottom: 0 !important;
        border-radius: 8px !important;
        flex-shrink: 0;
    }

    .current-song-info {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        justify-content: center;
        flex: 1;
        min-width: 0; /* Text truncation fix */
    }

    .current-song-title-row {
        width: 100%;
        justify-content: flex-start !important;
        margin-bottom: 4px;
    }
    
    .current-song-title {
        font-size: 1.1rem !important;
    }

    /* [Playlist] The main scrollable area */
    .playlist {
        flex: 1; /* Take remaining height */
        margin: 0 !important;
        padding: 10px !important;
        /* Reset specific desktop paddings */
        padding-top: 10px !important; 
        display: flex !important;
        flex-direction: column;
        min-height: 0; /* Flexbox scrolling fix */
    }

    .playlist-header {
        position: relative !important;
        top: auto !important;
        left: auto !important;
        right: auto !important;
        margin-bottom: 10px;
        padding: 0 !important;
    }

    .playlist-scroll {
        display: block !important;
        flex: 1;
        overflow-y: auto;
    }

    /* [Lyrics] Hide on mobile to simplify layout (Desktop style implied clean layout) */
    /* Alternatively, could be a toggle, but let's hide for now to fit the request of "make it look good" */
    .lyrics {
        display: none !important;
    }

    /* [Controls] Sticky at bottom */
    .controls {
        flex: 0 0 auto;
        display: flex !important;
        flex-direction: column;
        gap: 8px;
        padding: 12px !important;
        margin: 0 !important;
        /* Ensure it's readable */
        background: rgba(255, 255, 255, 0.2) !important;
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px !important;
    }

    body.dark-mode .controls {
        background: rgba(0, 0, 0, 0.4) !important;
    }

    .transport-controls {
        width: 100%;
        display: flex;
        justify-content: center; /* Center buttons */
        gap: 20px;
    }

    .progress-container {
        width: 100%;
        min-width: 0;
        margin: 0;
    }

    /* Hide complex desktop controls */
    .control-trailing,
    .audio-tools {
        display: none !important;
    }

    /* --- 4. Hide Custom Mobile Elements from previous versions --- */
    .mobile-toolbar,
    .mobile-panel,
    .mobile-inline-lyrics,
    .mobile-quality-chip,
    .mobile-turntable,
    .mobile-overlay-scrim,
    .mobile-close-btn,
    #mobileBackground {
        display: none !important;
    }
}